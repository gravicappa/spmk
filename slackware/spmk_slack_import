#!/usr/bin/env rc

for (file in /var/log/packages/*)
  awk -v 'file='$file -v 'pkgname='`{basename $file} 'BEGIN {
    name = pkgname
    sub(/-[0-9].*$/, "", name)
    tail = pkgname
    sub("^" name "-", "", tail)
    n = split(tail, x, "-")
    ver = x[1]
    pkgver = x[n]
    printf "%s-%s-%s: %s\n\n", name, ver, pkgver, file
  }'
