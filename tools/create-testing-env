#!/usr/bin/env rc

testdir=root
nports=40

rm -rf $testdir

# where database of packages is stored  
mkdir -p $testdir/var/lib/spmk

# where fake port tree is generated
mkdir -p $testdir/usr/ports

pwd=`{pwd}

mk 'root='$pwd/$testdir 'prefix='$pwd/$testdir/usr \
   'etcdir='$pwd/$testdir/etc || exit 1

./tools/generate-fake-ports $testdir/usr/ports $nports

cp ./tools/*.key $pwd/$testdir/etc/spmk/

echo 'usr/bin/pcc' >> $pwd/$testdir/etc/spmk/exclude
echo 'usr/share/dev/file' >> $pwd/$testdir/etc/spmk/save
